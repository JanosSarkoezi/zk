# Quickfix-Listen

## Frage

Ich moechte mit fd oder rg eine Ausgaben haben die so aussieht wie vims
Quickfix-Listen, dabei sollte jede Date nur einmal in der Liste vorkommen. Geht
das?

## Antwort

Ja, das geht! Du kannst `rg` (ripgrep) oder `fd` so verwenden, dass die Ausgabe
**kompatibel mit Vims Quickfix-Liste** ist und **jede Datei nur einmal
erscheint**.


## Ziel:

* Ausgabeformat wie:

  ```
  path/to/file:line:column: message
  ```

  ‚Üí kompatibel mit Vim Quickfix.
* Nur **eine Zeile pro Datei**.

---

## L√∂sung mit `rg` (ripgrep)

### Nach "TODO" suchen, aber nur ein Treffer:

```bash
rg --with-filename --line-number --column --max-count=1 -g '*.c' 'TODO'
```

Aber das gibt nur **den ersten Treffer insgesamt**, nicht **pro Datei**.

### Trick: mit `--json` + `jq` pro Datei den ersten Treffer holen:

```bash
rg --json 'TODO' | jq -r '
  select(.type == "match") 
  | .data 
  | "\(.path.text):\(.lines.text | split("\n")[0]):\(.line_number):" 
' | awk '!seen[$1]++'
```

### Alternativ einfacher mit `awk` direkt:

```bash
rg --with-filename --line-number --column 'TODO' | awk -F: '!seen[$1]++'
```

Erkl√§rung:

* `rg ...` gibt `filename:line:column:match` aus
* `awk` pr√ºft, ob `$1` (der Dateiname) schon gesehen wurde ‚Üí nur **erste Zeile pro Datei**

---

## L√∂sung mit `fd`

Da `fd` nicht nach Inhalten sucht, brauchst du `fd` + `rg`:

```bash
fd -e c -x rg --with-filename --line-number --column 'TODO' {} | awk -F: '!seen[$1]++'
```

üîπ Das sucht in allen `.c`-Dateien mit `rg` nach `TODO` und filtert pro Datei den ersten Treffer.

---

## Test in Vim

1. Speichere das Ergebnis in eine Datei:

   ```bash
   rg --with-filename --line-number --column 'TODO' | awk -F: '!seen[$1]++' > qf.txt
   ```

2. Lade in Vim:

   ```vim
   :cfile qf.txt
   :copen
   ```

Quickfix-Listen k√∂nnen √ºber verschiedene Befehle erstellt werden.
```vim
:vimgrep /TODO/ **/*.py
:copen
```

" Dann eine andere Liste
```vim
:grep Error *.log
:copen
```

```vim
:cexpr system("rg --vimgrep 'vim'")
```

```vim
" Jetzt kannst du zwischen den Listen wechseln:
:colder   " zur√ºck zur TODO-Liste
:cnewer   " wieder zur Error-Liste
```

